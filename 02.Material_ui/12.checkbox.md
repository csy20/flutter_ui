# Checkbox in Flutter Material UI

## What is Checkbox?

Checkbox is a Material Design component that allows users to select one or more options from a set. It represents a boolean value - checked (true) or unchecked (false), and can also have an indeterminate state. Checkboxes are commonly used in forms, settings, to-do lists, and anywhere users need to make multiple selections from a list of options.

## Key Features

- **Boolean Selection**: Represents true/false or on/off states
- **Material Design**: Follows platform conventions with smooth animations
- **Tri-state Support**: Can be checked, unchecked, or indeterminate
- **Customizable**: Colors, sizes, and styling can be modified
- **Accessibility**: Built-in screen reader support and keyboard navigation
- **Interactive**: Touch-friendly with proper touch targets
- **Group Management**: Can be used in groups for multiple selections

## Basic Checkbox Structure

```dart
import 'package:flutter/material.dart';

class BasicCheckboxExample extends StatefulWidget {
  @override
  _BasicCheckboxExampleState createState() => _BasicCheckboxExampleState();
}

class _BasicCheckboxExampleState extends State<BasicCheckboxExample> {
  bool isChecked = false;

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        title: Text('Basic Checkbox'),
      ),
      body: Center(
        child: Column(
          mainAxisAlignment: MainAxisAlignment.center,
          children: [
            Checkbox(
              value: isChecked,
              onChanged: (bool? value) {
                setState(() {
                  isChecked = value ?? false;
                });
              },
            ),
            SizedBox(height: 16),
            Text(
              'Checkbox is ${isChecked ? 'checked' : 'unchecked'}',
              style: TextStyle(fontSize: 18),
            ),
            SizedBox(height: 16),
            ElevatedButton(
              onPressed: () {
                setState(() {
                  isChecked = !isChecked;
                });
              },
              child: Text('Toggle Checkbox'),
            ),
          ],
        ),
      ),
    );
  }
}
```

## Checkbox Properties and Customization

### 1. Basic Properties
```dart
Checkbox(
  value: isChecked,                    // Current state (true/false/null)
  onChanged: (bool? value) {},         // Callback when state changes
  activeColor: Colors.blue,            // Color when checked
  checkColor: Colors.white,            // Color of the checkmark
  focusColor: Colors.blue.withOpacity(0.2), // Focus color
  hoverColor: Colors.blue.withOpacity(0.1), // Hover color
  tristate: false,                     // Allow null/indeterminate state
  materialTapTargetSize: MaterialTapTargetSize.shrinkWrap, // Touch target size
)
```

### 2. CheckboxListTile (Recommended)
```dart
CheckboxListTile(
  title: Text('Option 1'),
  subtitle: Text('Description of option 1'),
  value: isChecked,
  onChanged: (bool? value) {
    setState(() {
      isChecked = value ?? false;
    });
  },
  secondary: Icon(Icons.settings),     // Leading widget
  controlAffinity: ListTileControlAffinity.trailing, // Checkbox position
  activeColor: Colors.blue,
  checkColor: Colors.white,
  selected: isChecked,                 // Highlight when selected
)
```

### 3. Tri-state Checkbox
```dart
bool? triStateValue; // Can be true, false, or null

Checkbox(
  value: triStateValue,
  tristate: true,                      // Enable tri-state
  onChanged: (bool? value) {
    setState(() {
      if (triStateValue == false) {
        triStateValue = null;          // false -> null (indeterminate)
      } else if (triStateValue == null) {
        triStateValue = true;          // null -> true
      } else {
        triStateValue = false;         // true -> false
      }
    });
  },
)
```

## Complete Implementation Examples

### Example 1: Settings Panel with Multiple Checkboxes
```dart
import 'package:flutter/material.dart';

void main() {
  runApp(MyApp());
}

class MyApp extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return MaterialApp(
      title: 'Checkbox Demo',
      theme: ThemeData(
        primarySwatch: Colors.blue,
      ),
      home: SettingsPanel(),
    );
  }
}

class SettingsPanel extends StatefulWidget {
  @override
  _SettingsPanelState createState() => _SettingsPanelState();
}

class _SettingsPanelState extends State<SettingsPanel> {
  // Notification settings
  bool pushNotifications = true;
  bool emailNotifications = false;
  bool smsNotifications = false;
  bool inAppNotifications = true;

  // Privacy settings
  bool shareLocation = false;
  bool shareAnalytics = true;
  bool allowTracking = false;
  bool publicProfile = false;

  // App settings
  bool darkMode = false;
  bool autoSave = true;
  bool offlineMode = false;
  bool highQuality = true;

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        title: Text('Settings'),
        backgroundColor: Colors.blue,
        actions: [
          IconButton(
            icon: Icon(Icons.save),
            onPressed: _saveSettings,
          ),
        ],
      ),
      body: ListView(
        padding: EdgeInsets.all(16),
        children: [
          // Notifications Section
          _buildSectionHeader('Notifications', Icons.notifications),
          Card(
            child: Column(
              children: [
                CheckboxListTile(
                  title: Text('Push Notifications'),
                  subtitle: Text('Receive notifications on your device'),
                  value: pushNotifications,
                  onChanged: (value) {
                    setState(() {
                      pushNotifications = value ?? false;
                    });
                  },
                  secondary: Icon(Icons.phone_android, color: Colors.blue),
                  activeColor: Colors.blue,
                ),
                Divider(height: 1),
                CheckboxListTile(
                  title: Text('Email Notifications'),
                  subtitle: Text('Receive notifications via email'),
                  value: emailNotifications,
                  onChanged: (value) {
                    setState(() {
                      emailNotifications = value ?? false;
                    });
                  },
                  secondary: Icon(Icons.email, color: Colors.green),
                  activeColor: Colors.green,
                ),
                Divider(height: 1),
                CheckboxListTile(
                  title: Text('SMS Notifications'),
                  subtitle: Text('Receive notifications via SMS'),
                  value: smsNotifications,
                  onChanged: (value) {
                    setState(() {
                      smsNotifications = value ?? false;
                    });
                  },
                  secondary: Icon(Icons.sms, color: Colors.orange),
                  activeColor: Colors.orange,
                ),
                Divider(height: 1),
                CheckboxListTile(
                  title: Text('In-App Notifications'),
                  subtitle: Text('Show notifications within the app'),
                  value: inAppNotifications,
                  onChanged: (value) {
                    setState(() {
                      inAppNotifications = value ?? false;
                    });
                  },
                  secondary: Icon(Icons.notifications_active, color: Colors.purple),
                  activeColor: Colors.purple,
                ),
              ],
            ),
          ),

          SizedBox(height: 24),

          // Privacy Section
          _buildSectionHeader('Privacy', Icons.privacy_tip),
          Card(
            child: Column(
              children: [
                CheckboxListTile(
                  title: Text('Share Location'),
                  subtitle: Text('Allow app to access your location'),
                  value: shareLocation,
                  onChanged: (value) {
                    setState(() {
                      shareLocation = value ?? false;
                    });
                  },
                  secondary: Icon(Icons.location_on, color: Colors.red),
                  activeColor: Colors.red,
                ),
                Divider(height: 1),
                CheckboxListTile(
                  title: Text('Share Analytics'),
                  subtitle: Text('Help improve the app with usage data'),
                  value: shareAnalytics,
                  onChanged: (value) {
                    setState(() {
                      shareAnalytics = value ?? false;
                    });
                  },
                  secondary: Icon(Icons.analytics, color: Colors.indigo),
                  activeColor: Colors.indigo,
                ),
                Divider(height: 1),
                CheckboxListTile(
                  title: Text('Allow Tracking'),
                  subtitle: Text('Allow tracking for personalized ads'),
                  value: allowTracking,
                  onChanged: (value) {
                    setState(() {
                      allowTracking = value ?? false;
                    });
                  },
                  secondary: Icon(Icons.track_changes, color: Colors.brown),
                  activeColor: Colors.brown,
                ),
                Divider(height: 1),
                CheckboxListTile(
                  title: Text('Public Profile'),
                  subtitle: Text('Make your profile visible to others'),
                  value: publicProfile,
                  onChanged: (value) {
                    setState(() {
                      publicProfile = value ?? false;
                    });
                  },
                  secondary: Icon(Icons.public, color: Colors.teal),
                  activeColor: Colors.teal,
                ),
              ],
            ),
          ),

          SizedBox(height: 24),

          // App Settings Section
          _buildSectionHeader('App Settings', Icons.settings),
          Card(
            child: Column(
              children: [
                CheckboxListTile(
                  title: Text('Dark Mode'),
                  subtitle: Text('Use dark theme for the app'),
                  value: darkMode,
                  onChanged: (value) {
                    setState(() {
                      darkMode = value ?? false;
                    });
                  },
                  secondary: Icon(Icons.dark_mode, color: Colors.grey[800]),
                  activeColor: Colors.grey[800],
                ),
                Divider(height: 1),
                CheckboxListTile(
                  title: Text('Auto Save'),
                  subtitle: Text('Automatically save your work'),
                  value: autoSave,
                  onChanged: (value) {
                    setState(() {
                      autoSave = value ?? false;
                    });
                  },
                  secondary: Icon(Icons.save, color: Colors.blue),
                  activeColor: Colors.blue,
                ),
                Divider(height: 1),
                CheckboxListTile(
                  title: Text('Offline Mode'),
                  subtitle: Text('Enable offline functionality'),
                  value: offlineMode,
                  onChanged: (value) {
                    setState(() {
                      offlineMode = value ?? false;
                    });
                  },
                  secondary: Icon(Icons.offline_bolt, color: Colors.amber),
                  activeColor: Colors.amber,
                ),
                Divider(height: 1),
                CheckboxListTile(
                  title: Text('High Quality'),
                  subtitle: Text('Use high quality images and videos'),
                  value: highQuality,
                  onChanged: (value) {
                    setState(() {
                      highQuality = value ?? false;
                    });
                  },
                  secondary: Icon(Icons.high_quality, color: Colors.pink),
                  activeColor: Colors.pink,
                ),
              ],
            ),
          ),

          SizedBox(height: 24),

          // Summary Card
          Card(
            color: Colors.blue.shade50,
            child: Padding(
              padding: EdgeInsets.all(16),
              child: Column(
                crossAxisAlignment: CrossAxisAlignment.start,
                children: [
                  Text(
                    'Settings Summary',
                    style: TextStyle(
                      fontSize: 18,
                      fontWeight: FontWeight.bold,
                      color: Colors.blue[800],
                    ),
                  ),
                  SizedBox(height: 8),
                  Text('Notifications: ${_getEnabledCount([pushNotifications, emailNotifications, smsNotifications, inAppNotifications])}/4 enabled'),
                  Text('Privacy: ${_getEnabledCount([shareLocation, shareAnalytics, allowTracking, publicProfile])}/4 enabled'),
                  Text('App Settings: ${_getEnabledCount([darkMode, autoSave, offlineMode, highQuality])}/4 enabled'),
                ],
              ),
            ),
          ),
        ],
      ),
    );
  }

  Widget _buildSectionHeader(String title, IconData icon) {
    return Padding(
      padding: EdgeInsets.symmetric(vertical: 8),
      child: Row(
        children: [
          Icon(icon, color: Colors.blue),
          SizedBox(width: 8),
          Text(
            title,
            style: TextStyle(
              fontSize: 20,
              fontWeight: FontWeight.bold,
              color: Colors.blue[800],
            ),
          ),
        ],
      ),
    );
  }

  int _getEnabledCount(List<bool> settings) {
    return settings.where((setting) => setting).length;
  }

  void _saveSettings() {
    // Simulate saving settings
    showDialog(
      context: context,
      builder: (context) => AlertDialog(
        title: Text('Settings Saved'),
        content: Text('Your preferences have been saved successfully.'),
        actions: [
          TextButton(
            onPressed: () => Navigator.pop(context),
            child: Text('OK'),
          ),
        ],
      ),
    );
  }
}
```

### Example 2: To-Do List with Checkboxes
```dart
import 'package:flutter/material.dart';

class TodoListExample extends StatefulWidget {
  @override
  _TodoListExampleState createState() => _TodoListExampleState();
}

class _TodoListExampleState extends State<TodoListExample> {
  final TextEditingController _todoController = TextEditingController();
  List<TodoItem> _todos = [
    TodoItem(id: 1, title: 'Buy groceries', completed: false, category: 'Shopping'),
    TodoItem(id: 2, title: 'Finish project report', completed: true, category: 'Work'),
    TodoItem(id: 3, title: 'Call dentist', completed: false, category: 'Health'),
    TodoItem(id: 4, title: 'Read book', completed: false, category: 'Personal'),
    TodoItem(id: 5, title: 'Exercise', completed: true, category: 'Health'),
  ];

  String _selectedCategory = 'All';
  final List<String> _categories = ['All', 'Work', 'Personal', 'Shopping', 'Health'];

  @override
  Widget build(BuildContext context) {
    final filteredTodos = _selectedCategory == 'All'
        ? _todos
        : _todos.where((todo) => todo.category == _selectedCategory).toList();

    final completedCount = filteredTodos.where((todo) => todo.completed).length;
    final totalCount = filteredTodos.length;

    return Scaffold(
      appBar: AppBar(
        title: Text('Todo List'),
        backgroundColor: Colors.green,
        actions: [
          IconButton(
            icon: Icon(Icons.filter_list),
            onPressed: _showFilterDialog,
          ),
          IconButton(
            icon: Icon(Icons.delete_sweep),
            onPressed: _clearCompleted,
          ),
        ],
      ),
      body: Column(
        children: [
          // Progress Header
          Container(
            padding: EdgeInsets.all(16),
            decoration: BoxDecoration(
              gradient: LinearGradient(
                colors: [Colors.green.shade100, Colors.green.shade50],
              ),
            ),
            child: Row(
              children: [
                Expanded(
                  child: Column(
                    crossAxisAlignment: CrossAxisAlignment.start,
                    children: [
                      Text(
                        'Progress',
                        style: TextStyle(
                          fontSize: 18,
                          fontWeight: FontWeight.bold,
                          color: Colors.green[800],
                        ),
                      ),
                      SizedBox(height: 4),
                      Text(
                        '$completedCount of $totalCount tasks completed',
                        style: TextStyle(color: Colors.green[600]),
                      ),
                    ],
                  ),
                ),
                CircularProgressIndicator(
                  value: totalCount > 0 ? completedCount / totalCount : 0,
                  backgroundColor: Colors.green.shade200,
                  valueColor: AlwaysStoppedAnimation<Color>(Colors.green),
                ),
              ],
            ),
          ),

          // Category Filter
          Container(
            height: 50,
            child: ListView.builder(
              scrollDirection: Axis.horizontal,
              padding: EdgeInsets.symmetric(horizontal: 16),
              itemCount: _categories.length,
              itemBuilder: (context, index) {
                final category = _categories[index];
                final isSelected = category == _selectedCategory;
                return Padding(
                  padding: EdgeInsets.only(right: 8),
                  child: FilterChip(
                    label: Text(category),
                    selected: isSelected,
                    onSelected: (selected) {
                      setState(() {
                        _selectedCategory = category;
                      });
                    },
                    selectedColor: Colors.green.shade100,
                    checkmarkColor: Colors.green,
                  ),
                );
              },
            ),
          ),

          // Todo List
          Expanded(
            child: filteredTodos.isEmpty
                ? Center(
                    child: Column(
                      mainAxisAlignment: MainAxisAlignment.center,
                      children: [
                        Icon(Icons.task_alt, size: 64, color: Colors.grey),
                        SizedBox(height: 16),
                        Text(
                          'No tasks found',
                          style: TextStyle(fontSize: 18, color: Colors.grey),
                        ),
                        Text('Add a new task to get started'),
                      ],
                    ),
                  )
                : ListView.builder(
                    padding: EdgeInsets.all(16),
                    itemCount: filteredTodos.length,
                    itemBuilder: (context, index) {
                      final todo = filteredTodos[index];
                      return _buildTodoItem(todo);
                    },
                  ),
          ),
        ],
      ),
      floatingActionButton: FloatingActionButton(
        onPressed: _showAddTodoDialog,
        backgroundColor: Colors.green,
        child: Icon(Icons.add),
      ),
    );
  }

  Widget _buildTodoItem(TodoItem todo) {
    return Card(
      margin: EdgeInsets.only(bottom: 8),
      child: CheckboxListTile(
        title: Text(
          todo.title,
          style: TextStyle(
            decoration: todo.completed ? TextDecoration.lineThrough : null,
            color: todo.completed ? Colors.grey : null,
          ),
        ),
        subtitle: Row(
          children: [
            Container(
              padding: EdgeInsets.symmetric(horizontal: 8, vertical: 2),
              decoration: BoxDecoration(
                color: _getCategoryColor(todo.category),
                borderRadius: BorderRadius.circular(12),
              ),
              child: Text(
                todo.category,
                style: TextStyle(
                  color: Colors.white,
                  fontSize: 12,
                ),
              ),
            ),
            if (todo.completed) ...[
              SizedBox(width: 8),
              Icon(Icons.check_circle, color: Colors.green, size: 16),
              SizedBox(width: 4),
              Text(
                'Completed',
                style: TextStyle(color: Colors.green, fontSize: 12),
              ),
            ],
          ],
        ),
        value: todo.completed,
        onChanged: (value) {
          setState(() {
            todo.completed = value ?? false;
          });
        },
        secondary: PopupMenuButton(
          icon: Icon(Icons.more_vert),
          itemBuilder: (context) => [
            PopupMenuItem(
              value: 'edit',
              child: Row(
                children: [
                  Icon(Icons.edit),
                  SizedBox(width: 8),
                  Text('Edit'),
                ],
              ),
            ),
            PopupMenuItem(
              value: 'delete',
              child: Row(
                children: [
                  Icon(Icons.delete, color: Colors.red),
                  SizedBox(width: 8),
                  Text('Delete', style: TextStyle(color: Colors.red)),
                ],
              ),
            ),
          ],
          onSelected: (value) {
            if (value == 'edit') {
              _editTodo(todo);
            } else if (value == 'delete') {
              _deleteTodo(todo);
            }
          },
        ),
        activeColor: Colors.green,
        controlAffinity: ListTileControlAffinity.leading,
      ),
    );
  }

  Color _getCategoryColor(String category) {
    switch (category) {
      case 'Work':
        return Colors.blue;
      case 'Personal':
        return Colors.purple;
      case 'Shopping':
        return Colors.orange;
      case 'Health':
        return Colors.red;
      default:
        return Colors.grey;
    }
  }

  void _showAddTodoDialog() {
    _todoController.clear();
    String selectedCategory = 'Personal';

    showDialog(
      context: context,
      builder: (context) => StatefulBuilder(
        builder: (context, setDialogState) => AlertDialog(
          title: Text('Add New Task'),
          content: Column(
            mainAxisSize: MainAxisSize.min,
            children: [
              TextField(
                controller: _todoController,
                decoration: InputDecoration(
                  labelText: 'Task title',
                  border: OutlineInputBorder(),
                ),
                autofocus: true,
              ),
              SizedBox(height: 16),
              DropdownButtonFormField<String>(
                value: selectedCategory,
                decoration: InputDecoration(
                  labelText: 'Category',
                  border: OutlineInputBorder(),
                ),
                items: _categories.skip(1).map((category) {
                  return DropdownMenuItem(
                    value: category,
                    child: Text(category),
                  );
                }).toList(),
                onChanged: (value) {
                  setDialogState(() {
                    selectedCategory = value!;
                  });
                },
              ),
            ],
          ),
          actions: [
            TextButton(
              onPressed: () => Navigator.pop(context),
              child: Text('Cancel'),
            ),
            ElevatedButton(
              onPressed: () {
                if (_todoController.text.isNotEmpty) {
                  setState(() {
                    _todos.add(TodoItem(
                      id: DateTime.now().millisecondsSinceEpoch,
                      title: _todoController.text,
                      completed: false,
                      category: selectedCategory,
                    ));
                  });
                  Navigator.pop(context);
                }
              },
              child: Text('Add'),
            ),
          ],
        ),
      ),
    );
  }

  void _editTodo(TodoItem todo) {
    _todoController.text = todo.title;
    String selectedCategory = todo.category;

    showDialog(
      context: context,
      builder: (context) => StatefulBuilder(
        builder: (context, setDialogState) => AlertDialog(
          title: Text('Edit Task'),
          content: Column(
            mainAxisSize: MainAxisSize.min,
            children: [
              TextField(
                controller: _todoController,
                decoration: InputDecoration(
                  labelText: 'Task title',
                  border: OutlineInputBorder(),
                ),
              ),
              SizedBox(height: 16),
              DropdownButtonFormField<String>(
                value: selectedCategory,
                decoration: InputDecoration(
                  labelText: 'Category',
                  border: OutlineInputBorder(),
                ),
                items: _categories.skip(1).map((category) {
                  return DropdownMenuItem(
                    value: category,
                    child: Text(category),
                  );
                }).toList(),
                onChanged: (value) {
                  setDialogState(() {
                    selectedCategory = value!;
                  });
                },
              ),
            ],
          ),
          actions: [
            TextButton(
              onPressed: () => Navigator.pop(context),
              child: Text('Cancel'),
            ),
            ElevatedButton(
              onPressed: () {
                if (_todoController.text.isNotEmpty) {
                  setState(() {
                    todo.title = _todoController.text;
                    todo.category = selectedCategory;
                  });
                  Navigator.pop(context);
                }
              },
              child: Text('Save'),
            ),
          ],
        ),
      ),
    );
  }

  void _deleteTodo(TodoItem todo) {
    showDialog(
      context: context,
      builder: (context) => AlertDialog(
        title: Text('Delete Task'),
        content: Text('Are you sure you want to delete "${todo.title}"?'),
        actions: [
          TextButton(
            onPressed: () => Navigator.pop(context),
            child: Text('Cancel'),
          ),
          ElevatedButton(
            onPressed: () {
              setState(() {
                _todos.remove(todo);
              });
              Navigator.pop(context);
            },
            style: ElevatedButton.styleFrom(backgroundColor: Colors.red),
            child: Text('Delete'),
          ),
        ],
      ),
    );
  }

  void _showFilterDialog() {
    showDialog(
      context: context,
      builder: (context) => AlertDialog(
        title: Text('Filter by Category'),
        content: Column(
          mainAxisSize: MainAxisSize.min,
          children: _categories.map((category) {
            return RadioListTile<String>(
              title: Text(category),
              value: category,
              groupValue: _selectedCategory,
              onChanged: (value) {
                setState(() {
                  _selectedCategory = value!;
                });
                Navigator.pop(context);
              },
            );
          }).toList(),
        ),
      ),
    );
  }

  void _clearCompleted() {
    showDialog(
      context: context,
      builder: (context) => AlertDialog(
        title: Text('Clear Completed'),
        content: Text('Remove all completed tasks?'),
        actions: [
          TextButton(
            onPressed: () => Navigator.pop(context),
            child: Text('Cancel'),
          ),
          ElevatedButton(
            onPressed: () {
              setState(() {
                _todos.removeWhere((todo) => todo.completed);
              });
              Navigator.pop(context);
            },
            child: Text('Clear'),
          ),
        ],
      ),
    );
  }

  @override
  void dispose() {
    _todoController.dispose();
    super.dispose();
  }
}

class TodoItem {
  int id;
  String title;
  bool completed;
  String category;

  TodoItem({
    required this.id,
    required this.title,
    required this.completed,
    required this.category,
  });
}
```

### Example 3: Multi-Select List with Tri-state Checkbox
```dart
import 'package:flutter/material.dart';

class MultiSelectExample extends StatefulWidget {
  @override
  _MultiSelectExampleState createState() => _MultiSelectExampleState();
}

class _MultiSelectExampleState extends State<MultiSelectExample> {
  List<SelectableItem> _items = [
    SelectableItem(id: 1, name: 'Apple', category: 'Fruits', selected: false),
    SelectableItem(id: 2, name: 'Banana', category: 'Fruits', selected: true),
    SelectableItem(id: 3, name: 'Orange', category: 'Fruits', selected: false),
    SelectableItem(id: 4, name: 'Carrot', category: 'Vegetables', selected: false),
    SelectableItem(id: 5, name: 'Broccoli', category: 'Vegetables', selected: true),
    SelectableItem(id: 6, name: 'Spinach', category: 'Vegetables', selected: true),
    SelectableItem(id: 7, name: 'Chicken', category: 'Meat', selected: false),
    SelectableItem(id: 8, name: 'Beef', category: 'Meat', selected: false),
    SelectableItem(id: 9, name: 'Fish', category: 'Meat', selected: true),
  ];

  @override
  Widget build(BuildContext context) {
    final categories = _items.map((item) => item.category).toSet().toList();
    final selectedCount = _items.where((item) => item.selected).length;

    return Scaffold(
      appBar: AppBar(
        title: Text('Multi-Select List'),
        backgroundColor: Colors.purple,
        actions: [
          IconButton(
            icon: Icon(Icons.select_all),
            onPressed: _selectAll,
          ),
          IconButton(
            icon: Icon(Icons.clear),
            onPressed: _clearAll,
          ),
        ],
      ),
      body: Column(
        children: [
          // Selection Summary
          Container(
            padding: EdgeInsets.all(16),
            color: Colors.purple.shade50,
            child: Row(
              children: [
                Icon(Icons.shopping_cart, color: Colors.purple),
                SizedBox(width: 8),
                Expanded(
                  child: Text(
                    '$selectedCount items selected',
                    style: TextStyle(
                      fontSize: 16,
                      fontWeight: FontWeight.bold,
                      color: Colors.purple[800],
                    ),
                  ),
                ),
                if (selectedCount > 0)
                  ElevatedButton(
                    onPressed: _showSelectedItems,
                    style: ElevatedButton.styleFrom(
                      backgroundColor: Colors.purple,
                    ),
                    child: Text('View Selected'),
                  ),
              ],
            ),
          ),

          // Category Lists
          Expanded(
            child: ListView.builder(
              itemCount: categories.length,
              itemBuilder: (context, index) {
                final category = categories[index];
                return _buildCategorySection(category);
              },
            ),
          ),
        ],
      ),
      floatingActionButton: selectedCount > 0
          ? FloatingActionButton.extended(
              onPressed: _processSelectedItems,
              backgroundColor: Colors.purple,
              icon: Icon(Icons.shopping_cart),
              label: Text('Add to Cart ($selectedCount)'),
            )
          : null,
    );
  }

  Widget _buildCategorySection(String category) {
    final categoryItems = _items.where((item) => item.category == category).toList();
    final selectedInCategory = categoryItems.where((item) => item.selected).length;
    final totalInCategory = categoryItems.length;

    bool? categoryState;
    if (selectedInCategory == 0) {
      categoryState = false;
    } else if (selectedInCategory == totalInCategory) {
      categoryState = true;
    } else {
      categoryState = null; // Indeterminate
    }

    return Card(
      margin: EdgeInsets.all(8),
      child: Column(
        children: [
          // Category Header with Tri-state Checkbox
          CheckboxListTile(
            title: Text(
              category,
              style: TextStyle(
                fontSize: 18,
                fontWeight: FontWeight.bold,
                color: Colors.purple[800],
              ),
            ),
            subtitle: Text('$selectedInCategory of $totalInCategory selected'),
            value: categoryState,
            tristate: true,
            onChanged: (value) {
              setState(() {
                final newState = value ?? (selectedInCategory > 0 ? false : true);
                for (final item in categoryItems) {
                  item.selected = newState;
                }
              });
            },
            secondary: Icon(
              _getCategoryIcon(category),
              color: Colors.purple,
            ),
            activeColor: Colors.purple,
            controlAffinity: ListTileControlAffinity.leading,
          ),
          Divider(height: 1),

          // Category Items
          ...categoryItems.map((item) => CheckboxListTile(
                title: Text(item.name),
                value: item.selected,
                onChanged: (value) {
                  setState(() {
                    item.selected = value ?? false;
                  });
                },
                secondary: CircleAvatar(
                  backgroundColor: Colors.purple.withOpacity(0.1),
                  child: Text(
                    item.name[0].toUpperCase(),
                    style: TextStyle(
                      color: Colors.purple,
                      fontWeight: FontWeight.bold,
                    ),
                  ),
                ),
                activeColor: Colors.purple,
                dense: true,
                contentPadding: EdgeInsets.only(left: 32, right: 16),
              )),
        ],
      ),
    );
  }

  IconData _getCategoryIcon(String category) {
    switch (category) {
      case 'Fruits':
        return Icons.apple;
      case 'Vegetables':
        return Icons.eco;
      case 'Meat':
        return Icons.restaurant;
      default:
        return Icons.category;
    }
  }

  void _selectAll() {
    setState(() {
      for (final item in _items) {
        item.selected = true;
      }
    });
  }

  void _clearAll() {
    setState(() {
      for (final item in _items) {
        item.selected = false;
      }
    });
  }

  void _showSelectedItems() {
    final selectedItems = _items.where((item) => item.selected).toList();
    
    showDialog(
      context: context,
      builder: (context) => AlertDialog(
        title: Text('Selected Items'),
        content: Container(
          width: double.maxFinite,
          child: ListView.builder(
            shrinkWrap: true,
            itemCount: selectedItems.length,
            itemBuilder: (context, index) {
              final item = selectedItems[index];
              return ListTile(
                leading: Icon(_getCategoryIcon(item.category)),
                title: Text(item.name),
                subtitle: Text(item.category),
                trailing: IconButton(
                  icon: Icon(Icons.remove_circle, color: Colors.red),
                  onPressed: () {
                    setState(() {
                      item.selected = false;
                    });
                    Navigator.pop(context);
                  },
                ),
              );
            },
          ),
        ),
        actions: [
          TextButton(
            onPressed: () => Navigator.pop(context),
            child: Text('Close'),
          ),
        ],
      ),
    );
  }

  void _processSelectedItems() {
    final selectedItems = _items.where((item) => item.selected).toList();
    
    showDialog(
      context: context,
      builder: (context) => AlertDialog(
        title: Text('Add to Cart'),
        content: Text('Add ${selectedItems.length} items to your cart?'),
        actions: [
          TextButton(
            onPressed: () => Navigator.pop(context),
            child: Text('Cancel'),
          ),
          ElevatedButton(
            onPressed: () {
              Navigator.pop(context);
              ScaffoldMessenger.of(context).showSnackBar(
                SnackBar(
                  content: Text('${selectedItems.length} items added to cart!'),
                  backgroundColor: Colors.green,
                ),
              );
              setState(() {
                for (final item in selectedItems) {
                  item.selected = false;
                }
              });
            },
            child: Text('Add to Cart'),
          ),
        ],
      ),
    );
  }
}

class SelectableItem {
  int id;
  String name;
  String category;
  bool selected;

  SelectableItem({
    required this.id,
    required this.name,
    required this.category,
    required this.selected,
  });
}
```

## Advanced Checkbox Features

### 1. Custom Checkbox Widget
```dart
class CustomCheckbox extends StatefulWidget {
  final bool value;
  final ValueChanged<bool?>? onChanged;
  final Color? activeColor;
  final Color? checkColor;
  final double size;
  final BorderRadius? borderRadius;

  const CustomCheckbox({
    Key? key,
    required this.value,
    this.onChanged,
    this.activeColor,
    this.checkColor,
    this.size = 24.0,
    this.borderRadius,
  }) : super(key: key);

  @override
  _CustomCheckboxState createState() => _CustomCheckboxState();
}

class _CustomCheckboxState extends State<CustomCheckbox>
    with SingleTickerProviderStateMixin {
  late AnimationController _controller;
  late Animation<double> _animation;

  @override
  void initState() {
    super.initState();
    _controller = AnimationController(
      duration: Duration(milliseconds: 200),
      vsync: this,
    );
    _animation = CurvedAnimation(parent: _controller, curve: Curves.easeInOut);
    
    if (widget.value) {
      _controller.forward();
    }
  }

  @override
  void didUpdateWidget(CustomCheckbox oldWidget) {
    super.didUpdateWidget(oldWidget);
    if (widget.value != oldWidget.value) {
      if (widget.value) {
        _controller.forward();
      } else {
        _controller.reverse();
      }
    }
  }

  @override
  Widget build(BuildContext context) {
    final activeColor = widget.activeColor ?? Theme.of(context).primaryColor;
    final checkColor = widget.checkColor ?? Colors.white;

    return GestureDetector(
      onTap: widget.onChanged != null
          ? () => widget.onChanged!(!widget.value)
          : null,
      child: AnimatedBuilder(
        animation: _animation,
        builder: (context, child) {
          return Container(
            width: widget.size,
            height: widget.size,
            decoration: BoxDecoration(
              color: Color.lerp(Colors.transparent, activeColor, _animation.value),
              border: Border.all(
                color: Color.lerp(Colors.grey, activeColor, _animation.value)!,
                width: 2,
              ),
              borderRadius: widget.borderRadius ?? BorderRadius.circular(4),
            ),
            child: _animation.value > 0.5
                ? Icon(
                    Icons.check,
                    size: widget.size * 0.7,
                    color: checkColor,
                  )
                : null,
          );
        },
      ),
    );
  }

  @override
  void dispose() {
    _controller.dispose();
    super.dispose();
  }
}
```

### 2. Checkbox Group Widget
```dart
class CheckboxGroup extends StatefulWidget {
  final List<String> options;
  final List<String> selectedOptions;
  final ValueChanged<List<String>>? onChanged;
  final String? title;
  final bool allowSelectAll;

  const CheckboxGroup({
    Key? key,
    required this.options,
    required this.selectedOptions,
    this.onChanged,
    this.title,
    this.allowSelectAll = true,
  }) : super(key: key);

  @override
  _CheckboxGroupState createState() => _CheckboxGroupState();
}

class _CheckboxGroupState extends State<CheckboxGroup> {
  late List<String> _selectedOptions;

  @override
  void initState() {
    super.initState();
    _selectedOptions = List.from(widget.selectedOptions);
  }

  @override
  Widget build(BuildContext context) {
    final allSelected = _selectedOptions.length == widget.options.length;
    final noneSelected = _selectedOptions.isEmpty;
    final selectAllState = allSelected ? true : (noneSelected ? false : null);

    return Card(
      child: Padding(
        padding: EdgeInsets.all(16),
        child: Column(
          crossAxisAlignment: CrossAxisAlignment.start,
          children: [
            if (widget.title != null) ...[
              Text(
                widget.title!,
                style: TextStyle(
                  fontSize: 18,
                  fontWeight: FontWeight.bold,
                ),
              ),
              SizedBox(height: 8),
            ],
            
            if (widget.allowSelectAll) ...[
              CheckboxListTile(
                title: Text(
                  'Select All',
                  style: TextStyle(fontWeight: FontWeight.w500),
                ),
                value: selectAllState,
                tristate: true,
                onChanged: (value) {
                  setState(() {
                    if (value == true) {
                      _selectedOptions = List.from(widget.options);
                    } else {
                      _selectedOptions.clear();
                    }
                  });
                  widget.onChanged?.call(_selectedOptions);
                },
                controlAffinity: ListTileControlAffinity.leading,
              ),
              Divider(),
            ],

            ...widget.options.map((option) {
              final isSelected = _selectedOptions.contains(option);
              return CheckboxListTile(
                title: Text(option),
                value: isSelected,
                onChanged: (value) {
                  setState(() {
                    if (value == true) {
                      _selectedOptions.add(option);
                    } else {
                      _selectedOptions.remove(option);
                    }
                  });
                  widget.onChanged?.call(_selectedOptions);
                },
                controlAffinity: ListTileControlAffinity.leading,
                dense: true,
              );
            }),
          ],
        ),
      ),
    );
  }
}

// Usage Example
class CheckboxGroupExample extends StatefulWidget {
  @override
  _CheckboxGroupExampleState createState() => _CheckboxGroupExampleState();
}

class _CheckboxGroupExampleState extends State<CheckboxGroupExample> {
  List<String> selectedHobbies = ['Reading'];
  List<String> selectedSkills = [];

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(title: Text('Checkbox Groups')),
      body: SingleChildScrollView(
        padding: EdgeInsets.all(16),
        child: Column(
          children: [
            CheckboxGroup(
              title: 'Hobbies',
              options: ['Reading', 'Gaming', 'Sports', 'Music', 'Cooking'],
              selectedOptions: selectedHobbies,
              onChanged: (selected) {
                setState(() {
                  selectedHobbies = selected;
                });
              },
            ),
            SizedBox(height: 16),
            CheckboxGroup(
              title: 'Skills',
              options: ['Flutter', 'React', 'Python', 'JavaScript', 'Design'],
              selectedOptions: selectedSkills,
              onChanged: (selected) {
                setState(() {
                  selectedSkills = selected;
                });
              },
            ),
            SizedBox(height: 24),
            Card(
              child: Padding(
                padding: EdgeInsets.all(16),
                child: Column(
                  crossAxisAlignment: CrossAxisAlignment.start,
                  children: [
                    Text(
                      'Selection Summary',
                      style: TextStyle(fontSize: 18, fontWeight: FontWeight.bold),
                    ),
                    SizedBox(height: 8),
                    Text('Hobbies: ${selectedHobbies.join(', ')}'),
                    Text('Skills: ${selectedSkills.join(', ')}'),
                  ],
                ),
              ),
            ),
          ],
        ),
      ),
    );
  }
}
```

## Checkbox Best Practices

### 1. **Clear Labels**
```dart
// Good: Descriptive labels
CheckboxListTile(
  title: Text('Send me email notifications'),
  subtitle: Text('Receive updates about new features and promotions'),
  value: emailNotifications,
  onChanged: (value) => setState(() => emailNotifications = value!),
)

// Avoid: Vague labels
CheckboxListTile(
  title: Text('Enable'), // Too vague
  value: someOption,
  onChanged: (value) => setState(() => someOption = value!),
)
```

### 2. **Logical Grouping**
```dart
// Group related checkboxes
Card(
  child: Column(
    children: [
      Text('Notification Settings'),
      CheckboxListTile(/* Email notifications */),
      CheckboxListTile(/* Push notifications */),
      CheckboxListTile(/* SMS notifications */),
    ],
  ),
)
```

### 3. **State Management**
```dart
// Use proper state management for complex forms
class FormData {
  bool emailNotifications = false;
  bool pushNotifications = true;
  List<String> selectedCategories = [];
  
  // Methods to manage state
  void updateEmailNotifications(bool value) {
    emailNotifications = value;
  }
  
  void toggleCategory(String category) {
    if (selectedCategories.contains(category)) {
      selectedCategories.remove(category);
    } else {
      selectedCategories.add(category);
    }
  }
}
```

### 4. **Accessibility**
```dart
CheckboxListTile(
  title: Text('Important Option'),
  subtitle: Text('This option affects your account security'),
  value: isChecked,
  onChanged: (value) => setState(() => isChecked = value!),
  // Automatically provides semantic labels for screen readers
)
```

### 5. **Visual Feedback**
```dart
CheckboxListTile(
  title: Text('Option'),
  value: isChecked,
  onChanged: (value) => setState(() => isChecked = value!),
  activeColor: Colors.blue,          // Color when checked
  checkColor: Colors.white,          // Checkmark color
  selected: isChecked,               // Highlight entire tile when selected
  selectedTileColor: Colors.blue.withOpacity(0.1),
)
```

## Common Checkbox Patterns

### 1. **Settings Panel**
- Grouped settings with categories
- Toggle switches for preferences
- Clear descriptions for each option

### 2. **To-Do Lists**
- Task completion tracking
- Category-based organization
- Progress indicators

### 3. **Multi-Selection Lists**
- Item selection with tri-state parent checkboxes
- Bulk actions (select all, clear all)
- Category-based filtering

### 4. **Form Agreements**
- Terms and conditions acceptance
- Newsletter subscriptions
- Privacy policy agreements

### 5. **Shopping Lists**
- Item selection for purchase
- Category organization
- Completion tracking

## Checkbox vs Other Selection Widgets

### Use Checkbox when:
- Multiple independent options can be selected
- Boolean (on/off) states are needed
- Options are not mutually exclusive
- Users need to see all options at once

### Use Radio Button when:
- Only one option can be selected from a group
- Options are mutually exclusive
- Clear indication of current selection is needed

### Use Switch when:
- Binary on/off states are needed
- Immediate effect is expected
- Status change is the primary action

## Key Takeaways

1. **Material Design Integration**: Checkbox follows platform conventions automatically
2. **State Management**: Proper handling of boolean states and callbacks
3. **Tri-state Support**: Use for parent-child relationships in groups
4. **Visual Feedback**: Clear indication of checked/unchecked states
5. **Accessibility**: Built-in screen reader support and keyboard navigation
6. **User Experience**: Clear labels and logical grouping
7. **Performance**: Efficient state updates with proper setState usage
8. **Customization**: Flexible styling while maintaining usability
9. **Group Management**: Effective handling of multiple checkbox selections
10. **Form Integration**: Seamless integration with forms and validation

Checkbox is an essential input component for binary selections and multi-choice scenarios, providing users with clear, intuitive ways to make selections while maintaining excellent accessibility and user experience standards.